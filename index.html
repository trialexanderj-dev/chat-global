<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Chat Global</title>
  <style>
    body { font-family: Arial; background:#111; color:#fff; }
    #chat { height: 300px; overflow-y: auto; border:1px solid #444; padding:10px; }
    input, button { padding:8px; margin-top:5px; width:100%; }
  </style>
</head>
<body>

<h2>Chat Global</h2>

<div id="login">
  <input id="username" placeholder="Escribe tu nombre de usuario">
  <button onclick="login()">Entrar al chat</button>
</div>

<div id="chatBox" style="display:none;">
  <div id="chat"></div>
  <input id="message" placeholder="Escribe un mensaje">
  <button onclick="sendMessage()">Enviar</button>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  const firebaseConfig = {
  apiKey: "AIzaSyAXMMWNEtbqipdYFrQ6Lu5Kkf9XK2rD6qs",
  authDomain: "global-chat-c1ecf.firebaseapp.com",
  databaseURL: "https://global-chat-c1ecf-default-rtdb.firebaseio.com",
  projectId: "global-chat-c1ecf",
};

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const messagesRef = ref(db, "messages");

  let user = "";

  window.login = function() {
    const input = document.getElementById("username");
    if (input.value.trim() === "") return alert("Escribe un nombre");
    user = input.value;
    document.getElementById("login").style.display = "none";
    document.getElementById("chatBox").style.display = "block";
  };

  window.sendMessage = function() {
    const msg = document.getElementById("message").value;
    if (msg.trim() === "") return;
    push(messagesRef, { user, text: msg });
    document.getElementById("message").value = "";
  };

  onChildAdded(messagesRef, (data) => {
    const { user, text } = data.val();
    const chat = document.getElementById("chat");
    chat.innerHTML += `<p><b>${user}:</b> ${text}</p>`;
    chat.scrollTop = chat.scrollHeight;
  });
</script>

</body>
</html>
